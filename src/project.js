require=function s(a,r,c){function h(e,t){if(!r[e]){if(!a[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(l)return l(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var o=r[e]={exports:{}};a[e][0].call(o.exports,function(t){return h(a[e][1][t]||t)},o,o.exports,s,a,r,c)}return r[e].exports}for(var l="function"==typeof require&&require,t=0;t<c.length;t++)h(c[t]);return h}({Animal:[function(t,e,i){"use strict";cc._RF.push(e,"2eaebp4IA9Dp4D+JPd+9a47","Animal");var n=t("./Common/BaseComponent");cc.Class({extends:n,properties:{totalBlood:100,bloodBar:{default:null,type:cc.Node},damage:10,walkSpeed:200,runSpeed:400},start:function(){this.remain=this.totalBlood,this.bloodBarComponent=this.bloodBar.getComponent("BloodBar"),this.bloodBarComponent.setRemain(this.node.name,this.remain,this.totalBlood),this.skeletonInit()},skeletonInit:function(){this.skeleton=this.getComponent("sp.Skeleton"),this.skeleton.setAnimationListener(this,this.onAnimationStatusChange)},beenHit:function(t){this.remain-=t.damage,this.bloodBarComponent.setRemain(this.node.name,this.remain,this.totalBlood),this.info("been hit, remine "+this.blood+" blood left"),this.remain<=0&&this.onDie()},onDie:function(){},moveable:function(){return!1},nowSpeed:function(){return 0},moveArea:function(){return this.node.parent.getComponent(n).getBounds()},onRightLimit:function(){},onLeftLimit:function(){},update:function(t){if(this.moveable()){this.node.x+=this.nowSpeed()*t;var e=this.moveArea();this.node.x<e.left?(this.node.x=e.left,this.onLeftLimit()):this.node.x>e.right&&(this.node.x=e.right,this.onRightLimit())}}}),cc._RF.pop()},{"./Common/BaseComponent":"BaseComponent"}],Background:[function(t,e,i){"use strict";cc._RF.push(e,"93187V2cC1BA4VTi8koeX67","Background");var n=t("./Common/BaseComponent");cc.Class({extends:n,properties:{},onLoad:function(){cc.log("background onload")},start:function(){cc.log("background start")}}),cc._RF.pop()},{"./Common/BaseComponent":"BaseComponent"}],BaseComponent:[function(t,e,i){"use strict";cc._RF.push(e,"f0e29Ra6P9C4ZpemAmhqJ6X","BaseComponent"),cc.Class({extends:cc.Component,properties:{},info:function(t){cc.info("["+this.__classname__+"] "+t)},start:function(){this.info("base start")},getBounds:function(){return{left:-this.node.width*this.node.anchorX,right:this.node.width*(1-this.node.anchorX)}}}),cc._RF.pop()},{}],BloodBar:[function(t,e,i){"use strict";cc._RF.push(e,"b73490XhwlAkq6o23c/1F5J","BloodBar");var n=t("./Common/BaseComponent");cc.Class({extends:n,properties:{border:5,borderColor:{default:cc.Color.WHITE,type:cc.Color},playFillColor:{default:cc.Color.RED,type:cc.Color},monsterFillColor:{default:cc.Color.BLUE,type:cc.Color}},start:function(){},setRemain:function(t,e,i){this.remain=e,"player"==t?this.draw(this.borderColor,this.playFillColor,e,i):"monster"==t&&this.draw(this.borderColor,this.monsterFillColor,e,i)},draw:function(t,e,i,n){var o=this.getComponent(cc.Graphics);o.clear(),o.rect(0,0,this.node.width,this.node.height),o.strokeColor=t,o.strokeColor.a=100,o.lineWidth=this.border,o.stroke(),o.rect(this.border/2,this.border/2,(this.node.width-this.border)*i/n,this.node.height-this.border),o.fillColor=e,o.fillColor.a=200,o.lineWidth=0,o.fill()},update:function(t){}}),cc._RF.pop()},{"./Common/BaseComponent":"BaseComponent"}],Bullet:[function(t,e,i){"use strict";cc._RF.push(e,"98590UW2FJFk63fVTODzBJI","Bullet");var s=t("./Common/Util"),n=(s.DIRECTION,t("./Common/BaseComponent"));cc.Class({extends:n,properties:{},start:function(){},init:function(t,e,i,n){this.node.x=e,this.node.y=i,this.damage=n,s.updateDirection(this.node,t);var o=cc.moveTo(1,cc.p(e+this.node.parent.width*t,i));this.node.runAction(o)},onCollisionEnter:function(t,e){this.info("collision with monster enter."),"monster"==t.node.getName()&&this.node.destroy()},onCollisionExit:function(t,e){this.info("collision with monster. exit")}}),cc._RF.pop()},{"./Common/BaseComponent":"BaseComponent","./Common/Util":"Util"}],CameraControl:[function(t,e,i){"use strict";cc._RF.push(e,"d8104ERMpFCDpHioInE17rS","CameraControl");var n=t("./Common/BaseComponent");cc.Class({extends:n,properties:{target:{default:null,type:cc.Node}},onLoad:function(){},start:function(){this.camera=this.getComponent(cc.Camera),this.parentBounds=this.node.parent.getComponent("Background").getBounds()},onEnable:function(){},onDisable:function(){},lateUpdate:function(t){var e=this.target.convertToWorldSpaceAR(cc.Vec2.ZERO),i=this.node.parent.convertToNodeSpaceAR(e),n=this.parentBounds.left,o=this.parentBounds.right;i.x<n+this.camera.viewPort.width/2?this.node.x=n+this.camera.viewPort.width/2:i.x>o-this.camera.viewPort.width/2?this.node.x=o-this.camera.viewPort.width/2:this.node.x=i.x}}),cc._RF.pop()},{"./Common/BaseComponent":"BaseComponent"}],Game:[function(t,e,i){"use strict";cc._RF.push(e,"280c3rsZJJKnZ9RqbALVwtK","Game");var n=t("./Common/BaseComponent");cc.Class({extends:n,properties:{label:{default:null,type:cc.Label},text:"Hello, World!"},onLoad:function(){cc.log("Canvas onload"),this.collisionInit()},collisionInit:function(){this.collisionManager=cc.director.getCollisionManager(),this.collisionManager.enabled=!0},start:function(){cc.log("Canvas start")},update:function(t){}}),cc._RF.pop()},{"./Common/BaseComponent":"BaseComponent"}],Monster:[function(t,e,i){"use strict";cc._RF.push(e,"8ce6aPxjqFOqKAKLDigh2Nw","Monster");var n=t("./Common/Util"),o=t("Animal"),s=n.DIRECTION,a=0,r=1,c=2;cc.Class({extends:o,properties:{player:{default:null,type:cc.Node}},start:function(){this._super(),this.run(s.RIGHT)},onAnimationStatusChange:function(t,e,i){if(i==sp.AnimationEventType.COMPLETE)switch(e.animation.name){case"hit":this.info("hit complete"),this.run(this.direction);break;case"death":this.node.destroy()}},run:function(t){this.status==a&&this.direction==t||(this.info("monster run"),this.direction=t,this.status=a,this.skeleton.clearTracks(),this.skeleton.setAnimation(0,"run",!0),n.updateDirection(this.node,this.direction))},beenHit:function(t){this.info("monster been hit."),this.skeleton.clearTracks(),this.skeleton.setAnimation(1,"hit",!1),this.status=r,this._super(t)},onDie:function(){this.skeleton.clearTracks(),this.skeleton.setAnimation(1,"death",!1),this.status=c,this.info("die...")},moveable:function(){return!0},nowSpeed:function(){return this.status==a?this.runSpeed*this.direction:this.status==r?0:void 0},onRightLimit:function(){this.run(s.LEFT)},onLeftLimit:function(){this.run(s.RIGHT)},update:function(t){this.player.isValid&&this.status!=c&&(this.status!=r&&(this.player.x<this.node.x-2*this.runSpeed?this.run(s.LEFT):this.player.x>this.node.x+2*this.runSpeed&&this.run(s.RIGHT)),this._super(t))},onCollisionEnter:function(t,e){this.status!=c&&(this.info("collision with monster enter."),"bullet"==t.node.getName()&&this.beenHit(t.node.getComponent("Bullet")))},onCollisionExit:function(t,e){this.info("collision with monster. exit")}}),cc._RF.pop()},{"./Common/Util":"Util",Animal:"Animal"}],Player:[function(t,e,i){"use strict";cc._RF.push(e,"22815ydrMZLbodIkD7eY7z0","Player");var n=0,o=1,s=2,a=4,r=5,c=7,h=8,l=0,u=2,d=t("./Common/Util"),m=t("Animal"),p=d.DIRECTION;cc.Class({extends:m,properties:{doubleClickDuration:{default:200,displayName:"double click duration",tooltip:"double click duration to run"},bulletPrefab:{default:null,type:cc.Prefab}},start:function(){this._super(),this.anim=this.getComponent(cc.Animation),this.enventInit(),this.direction=p.RIGHT,this.idle(),this.parentBounds=this.node.parent.getComponent("Background").getBounds(),this.lastDTime=0,this.lastATime=0},onAnimationStatusChange:function(t,e,i){if(i==sp.AnimationEventType.COMPLETE)switch(e.animation.name){case"jump":this.status=r,this.idle();break;case"hit":this.idle();break;case"death":this.node.destroy(),this.over()}},walk:function(t){this.status!=o&&this.status!=a&&this.direction!=t&&(this.info("walk"),this.direction=t,this.skeleton.setAnimation(l,"walk",!0),this.status=o,d.updateDirection(this.node,this.direction))},run:function(t){(this.status!=s&&this.status!=a||this.direction!=t)&&(this.info("run"),this.direction=t,this.skeleton.setAnimation(l,"run",!0),this.status=s,d.updateDirection(this.node,this.direction))},jump:function(){this.status!=a&&(this.info("jump"),this.skeleton.setAnimation(l,"jump",!1),this.lastStatus=this.status,this.status=a,this.anim.play("PlayerJump"))},beenHit:function(t){var e=this.anim.play("BeenHit");this.status=c,this.skeleton.setAnimation(l,"hit",!1),e.repeatCount=6,this._super(t)},idle:function(){this.status!=n&&this.status!=a&&(this.info("idle"),this.status=n,this.skeleton.setAnimation(l,"idle",!0),d.updateDirection(this.node,this.direction))},shoot:function(){this.status!=a&&(this.info("shoot"),this.skeleton.setAnimation(u,"shoot",!1),this.bullet=cc.instantiate(this.bulletPrefab),this.node.parent.addChild(this.bullet),this.bullet.getComponent("Bullet").init(this.direction,this.node.x+200*this.direction,this.node.y+150,this.damage))},onDie:function(){this.skeleton.clearTracks(),this.skeleton.setAnimation(1,"death",!1),this.status=h,this.info("die...")},onKeyDowm:function(t){var e=(new Date).getTime();switch(event.keyCode){case cc.KEY.d:e-this.lastDTime<this.doubleClickDuration?this.run(p.RIGHT):this.walk(p.RIGHT),this.lastDTime=e;break;case cc.KEY.a:e-this.lastATime<this.doubleClickDuration?this.run(p.LEFT):this.walk(p.LEFT),this.lastATime=e;break;case cc.KEY.space:this.jump();break;case cc.KEY.q:this.shoot()}},onKeyUp:function(t){switch(t.keyCode){case cc.KEY.d:case cc.KEY.a:this.info("key up"),this.idle()}},enventInit:function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDowm,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},onCollisionEnter:function(t,e){this.isAlive()&&"monster"==t.node.getName()&&(this.info(t+"collision with player enter."),this.beenHit(t.node.getComponent("Monster")))},onCollisionExit:function(t,e){this.info(t+"collision with player exit")},moveable:function(){var t=this.status;return t==a&&(t=this.lastStatus),t==o||t==s},nowSpeed:function(){return this.runSpeed*this.direction},update:function(t){this._super(t)},isAlive:function(){return this.status!=h},over:function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDowm),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp)}}),cc._RF.pop()},{"./Common/Util":"Util",Animal:"Animal"}],Util:[function(t,e,i){"use strict";cc._RF.push(e,"b6db9yzQ6BJy6aUoY+C8Eqb","Util"),e.exports={DIRECTION:{LEFT:-1,UNDEFINED:0,RIGHT:1},updateDirection:function(t,e){switch(e){case this.DIRECTION.LEFT:t.scaleX=-Math.abs(t.scaleX);break;case this.DIRECTION.RIGHT:t.scaleX=Math.abs(t.scaleX);break;case this.DIRECTION.UNDEFINED:}},trace:function(t){var e=arguments.callee.caller,i=0;for(t=t||10,cc.log("***----------------------------------------  ** "+(i+1));e&&i<t;)cc.log(e.toString()),e=e.caller,i++,cc.log("***---------------------------------------- ** "+(i+1))}},cc._RF.pop()},{}]},{},["Animal","Background","BloodBar","Bullet","CameraControl","BaseComponent","Util","Game","Monster","Player"]);